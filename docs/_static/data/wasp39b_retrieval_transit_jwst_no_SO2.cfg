[pyrat]

# Pyrat Bay run mode [tli pt atmosphere spectrum radeq opacity mcmc]
runmode = retrieval

# Output file names
logfile = ret_wasp39b_no_SO2/WASP39b_jwst_no_SO2.log

# Verbosity level [1--3]:
verb = 2

# Observing geometry, select between: [transit eclipse emission]
rt_path = transit

# The observations
dunits = ppm
obsfile = ../inputs/obs_wasp39b_transit_jwst.dat

# Wavelength sampling
wl_low = 0.499 um
wl_high = 12.0 um


# System parameters
rstar = 0.9096 rsun
mstar = 0.9065 msun
tstar = 5512.0

rplanet = 1.2959 rjup
mplanet = 0.266 mjup
#     +/- 0.033 mjup
smaxis  = 0.0486 au
refpressure = 0.1 bar


# Atmospheric model:
nlayers = 81
ptop = 1e-9 bar
pbottom = 1e2 bar

# Temperature-profile model [isothermal guillot madhu]
tmodel = madhu
tpars = 1000.0

# Atmospheric composition and abundances:
chemistry = free
species =
    H2   He   Na   K    H2O  CH4   CO
    CO2  HCN  NH3  H2S  SO2  C2H2
uniform_vmr =
    0.85       0.1445     1.000e-10  1.000e-10  1.000e-10  1.000e-10  1.000e-10
    1.000e-10  1.000e-10  1.000e-10  1.000e-10  1.000e-10  1.000e-10

# Radius model (hydrostatic equilibrium)
radmodel = hydro_m


# Line-sampled cross sections:
sampled_cross_sec =
    ../run_opacity/cross_section_125-3500K_0.4-15.0um_R20K_H2O_exomol.npz
    ../run_opacity/cross_section_125-3500K_0.4-15.0um_R20K_CO2_hitemp.npz
    ../run_opacity/cross_section_125-3500K_0.4-15.0um_R20K_CO_hitemp.npz
    ../run_opacity/cross_section_125-3500K_0.4-15.0um_R20K_CH4_hitemp.npz
    ../run_opacity/cross_section_125-3500K_0.4-15.0um_R20K_HCN_exomol.npz
    ../run_opacity/cross_section_125-3500K_0.4-15.0um_R20K_NH3_exomol.npz
    ../run_opacity/cross_section_125-3500K_0.4-15.0um_R20K_H2S_exomol.npz
    ../run_opacity/cross_section_125-3500K_0.4-15.0um_R20K_C2H2_exomol.npz

# Continuum cross sections:
continuum_cross_sec =
    {ROOT}pyratbay/data/CIA/CIA_Borysow_H2H2_0060-7000K_0.6-500um.dat
    {ROOT}pyratbay/data/CIA/CIA_Borysow_H2He_0050-7000K_0.5-031um.dat

# Alkali opacity, select from: [sodium_vdw potassium_vdw]
alkali =
    sodium_vdw
    potassium_vdw

# Haze models, select from: [deck]
clouds = deck
cpars = 2.0

# Rayleigh models, select from: [lecavelier dalgarno_H dalgarno_He dalgarno_H2]
rayleigh = 
    dalgarno_H2
    dalgarno_He
    lecavelier
rpars = 0.0 -4.0

# VMR parameters (constant with altitude VMRs)
vmr_vars =
    log_H2O
    log_CO2
    log_CO
    log_SO2
    log_H2S
    log_HCN
    log_CH4
    log_NH3
    log_C2H2
    log_Na
    log_K

# Bulk species
bulk = H2 He

# Param name    value  lo_bound  hi_bound  step   prior  prior_sigma
retrieval_params = 
    log_p1        -4.0     -9.0       2.0   0.3
    log_p2        -7.2     -9.0       2.0   0.3
    log_p3        -1.0     -2.0       2.0   0.3
    a1            1.50     0.02       2.0   0.02
    a2            0.35     0.02       2.0   0.02
    T0           850.0    800.0    1300.0   30.0
    M_planet     0.266      0.1       0.43  0.05  0.266  0.033
    log_p_ref    -1.0      -9.0       2.0   0.3
    log_H2O      -1.70    -12.0      -0.3   0.3
    log_CO2      -3.00    -12.0      -0.3   0.3
    log_CO       -2.30    -12.0      -0.3   0.3
    log_SO2      -10.0    -12.0      -0.3   0.0
    log_H2S      -3.15    -12.0      -0.3   0.3
    log_HCN      -6.00    -12.0      -0.3   0.3
    log_CH4      -5.00    -12.0      -0.3   0.3
    log_NH3      -5.00    -12.0      -0.3   0.3
    log_C2H2     -8.00    -12.0      -0.3   0.3
    log_Na       -3.25    -12.0      -0.3   0.3
    log_K        -7.00    -12.0      -0.3   0.3
    log_k_ray      3.8     -4.0      10.0   0.3
    alpha_ray     -2.0    -20.0       2.0   0.1
    log_p_cl      -1.0     -9.0       2.0   0.3
    f_patchy       0.6      0.0       1.0   0.05


# Retrieval setup:
sampler = multinest
nlive = 1000
resume = True
theme = blue
data_color = xkcd:green
post_processing = False

# Retrieval temperature boundaries:
tlow  =  800
thigh = 2500

# If set, plot wavelength axes in log-scale, using these tick labels:
wl_ticks = 0.7 1.0 2.0 3.0 5.0 7.0 10.0
